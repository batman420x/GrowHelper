<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Hydroponischer Cannabis-Anbau</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .container {
            max-width: 800px;
            margin: auto;
        }
        .input-group {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="number"], select, input[type="text"] {
            flex: 1;
            padding: 8px;
            margin-left: 10px;
            box-sizing: border-box;
        }
        canvas {
            margin-top: 20px;
        }
        .chart-container {
            margin-top: 40px;
        }
        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        button {
            flex: 1;
            padding: 10px;
            margin: 5px;
            cursor: pointer;
        }
    </style>
</head>
<body>
<div class="container">
<h1>Hydroponischer Anbau von medizinischem Cannabis</h1>
<div class="input-group">
<label for="growthWeeks">Wachstumswochen:</label>
<input type="number" id="growthWeeks" value="4" min="1" max="16">
</div>
<div class="input-group">
<label for="bloomWeeks">Blütewochen:</label>
<input type="number" id="bloomWeeks" value="9" min="1" max="16">
</div>
<div class="input-group">
<label for="parameters">Parameter:</label>
<select id="parameters" multiple>
<option value="temp">Temperatur (°C)</option>
<option value="RLF">Relative Luftfeuchtigkeit (%)</option>
<option value="VPD">VPD (kPa)</option>
<option value="PH">pH-Wert</option>
<option value="EC">EC-Wert (mS/cm)</option>
<option value="PPFD">PPFD (µmol/m²/s)</option>
<option value="DLI">DLI (mol/m²/d)</option>
</select>
</div>
<div class="input-group">
<label for="currentValues">Aktuelle Werte (Komma getrennt):</label>
<input type="text" id="currentValues">
</div>
<div class="buttons">
<button onclick="updateChart()">Aktualisieren</button>
<button onclick="showSeparateCharts()">Einzelne Diagramme</button>
</div>
<canvas id="growthChart"></canvas>
</div>
<div class="container chart-container" id="separateChartsContainer"></div>
<script>
        document.addEventListener("DOMContentLoaded", function() {
            document.getElementById('parameters').selectedOptions = [{ value: 'temp' }, { value: 'RLF' }];
            updateChart();
        });

        const ctx = document.getElementById('growthChart').getContext('2d');
        let growthWeeks = document.getElementById('growthWeeks').value;
        let bloomWeeks = document.getElementById('bloomWeeks').value;

        const data = {
            labels: Array.from({ length: parseInt(growthWeeks) + parseInt(bloomWeeks) }, (_, i) => `Woche ${i + 1}`),
            datasets: []
        };

        const config = {
            type: 'line',
            data: data,
            options: {
                scales: {
                    y: {
                        beginAtZero: false
                    }
                }
            }
        };

        const chart = new Chart(ctx, config);

        const optimalRanges = {
            temp: {
                growth: [
                    [20, 25], [21, 26], [22, 27], [23, 27]
                ],
                bloom: [
                    [24, 28], [24, 28], [24, 28], [23, 27], [22, 26], [21, 25], [20, 24], [19, 24], [18, 23]
                ]
            },
            RLF: {
                growth: [
                    [65, 75], [60, 70], [55, 65], [50, 60]
                ],
                bloom: [
                    [50, 60], [50, 60], [45, 55], [45, 55], [40, 50], [40, 50], [40, 50], [40, 50], [40, 45]
                ]
            },
            VPD: {
                growth: [
                    [0.6, 0.8], [0.7, 0.9], [0.8, 1.0], [0.9, 1.1]
                ],
                bloom: [
                    [1.2, 1.4], [1.3, 1.5], [1.4, 1.6], [1.4, 1.6], [1.4, 1.6], [1.4, 1.6], [1.5, 1.7], [1.4, 1.6], [1.3, 1.5]
                ]
            },
            PH: {
                growth: [
                    [5.5, 5.8], [5.6, 5.9], [5.7, 6.0], [5.8, 6.1]
                ],
                bloom: [
                    [5.8, 6.1], [5.9, 6.2], [6.0, 6.3], [6.0, 6.3], [6.1, 6.4], [6.2, 6.5], [6.2, 6.5], [6.3, 6.5], [6.3, 6.5]
                ]
            },
            EC: {
                growth: [
                    [0.3, 0.6], [0.4, 0.7], [0.5, 0.8], [0.6, 1.1]
                ],
                bloom: [
                    [1.1, 1.4], [1.2, 1.5], [1.2, 1.6], [1.2, 1.7], [1.2, 1.8], [1.2, 1.9], [1.2, 2.0], [1.1, 2.0], [1.0, 2.0]
                ]
            },
            PPFD: {
                growth: [
                    [400, 500], [450, 550], [500, 600], [550, 650]
                ],
                bloom: [
                    [600, 700], [650, 750], [700, 800], [750, 850], [800, 900], [850, 950], [900, 1000], [950, 1050], [1000, 1100]
                ]
            },
            DLI: {
                growth: [
                    [20, 25], [22, 27], [24, 29], [26, 31]
                ],
                bloom: [
                    [28, 33], [30, 35], [32, 37], [34, 39], [36, 41], [38, 43], [40, 45], [42, 47], [44, 49]
                ]
            }
        };

        function updateChart() {
            growthWeeks = document.getElementById('growthWeeks').value;
            bloomWeeks = document.getElementById('bloomWeeks').value;
            const selectedParameters = Array.from(document.getElementById('parameters').selectedOptions).map(option => option.value);
            const currentValues = document.getElementById('currentValues').value.split(',').map(value => parseFloat(value.trim()));

            const totalWeeks = parseInt(growthWeeks) + parseInt(bloomWeeks);
            const labels = Array.from({ length: totalWeeks }, (_, i) => `Woche ${i + 1}`);
            data.labels = labels;
            data.datasets = [];

            selectedParameters.forEach((parameter, index) => {
                const minOptimal = [];
                const maxOptimal = [];
                for (let i = 0; i < totalWeeks; i++) {
                    const phase = i < growthWeeks ? 'growth' : 'bloom';
                    const weekIndex = i < growthWeeks ? i : i - growthWeeks;
                    minOptimal.push(optimalRanges[parameter][phase][weekIndex][0]);
                    maxOptimal.push(optimalRanges[parameter][phase][weekIndex][1]);
                }

                data.datasets.push({
                    label: `Minimaler Optimaler Wert (${parameter})`,
                    data: minOptimal,
                    borderColor: 'rgba(75, 192, 192, 1)',
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    fill: false,
                    stepped: true,
                });

                data.datasets.push({
                    label: `Maximaler Optimaler Wert (${parameter})`,
                    data: maxOptimal,
                    borderColor: 'rgba(54, 162, 235, 1)',
                    backgroundColor: 'rgba(54, 162, 235, 0.2)',
                    fill: false,
                    stepped: true,
                });

                if (currentValues[index] !== undefined) {
                    const current = Array(totalWeeks).fill(currentValues[index]);
                    data.datasets.push({
                        label: `Aktueller Wert (${parameter})`,
                        data: current,
                        borderColor: 'rgba(255, 99, 132, 1)',
                        backgroundColor: 'rgba(255, 99, 132, 0.2)',
                        fill: false,
                    });
                }
            });

            chart.update();
        }

        function showSeparateCharts() {
            const container = document.getElementById('separateChartsContainer');
            container.innerHTML = '';
            const selectedParameters = Array.from(document.getElementById('parameters').selectedOptions).map(option => option.value);
            const currentValues = document.getElementById('currentValues').value.split(',').map(value => parseFloat(value.trim()));

            selectedParameters.forEach((parameter, index) => {
                const canvas = document.createElement('canvas');
                container.appendChild(canvas);
                const ctx = canvas.getContext('2d');
                const minOptimal = [];
                const maxOptimal = [];
                const totalWeeks = parseInt(growthWeeks) + parseInt(bloomWeeks);

                                    for (let i = 0; i < totalWeeks; i++) {
                        const phase = i < growthWeeks ? 'growth' : 'bloom';
                        const weekIndex = i < growthWeeks ? i : i - growthWeeks;
                        minOptimal.push(optimalRanges[parameter][phase][weekIndex][0]);
                        maxOptimal.push(optimalRanges[parameter][phase][weekIndex][1]);
                    }

                    const separateChartData = {
                        labels: Array.from({ length: totalWeeks }, (_, i) => `Woche ${i + 1}`),
                        datasets: [
                            {
                                label: `Minimaler Optimaler Wert (${parameter})`,
                                data: minOptimal,
                                borderColor: 'rgba(75, 192, 192, 1)',
                                backgroundColor: 'rgba(75, 192, 192, 0.2)',
                                fill: false,
                                stepped: true,
                            },
                            {
                                label: `Maximaler Optimaler Wert (${parameter})`,
                                data: maxOptimal,
                                borderColor: 'rgba(54, 162, 235, 1)',
                                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                                fill: false,
                                stepped: true,
                            }
                        ]
                    };

                    if (currentValues[index] !== undefined) {
                        const current = Array(totalWeeks).fill(currentValues[index]);
                        separateChartData.datasets.push({
                            label: `Aktueller Wert (${parameter})`,
                            data: current,
                            borderColor: 'rgba(255, 99, 132, 1)',
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            fill: false,
                        });
                    }

                    new Chart(ctx, {
                        type: 'line',
                        data: separateChartData,
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: false
                                }
                            }
                        }
                    });
                });
            }
        </script>
</div>
</body>
</html>
